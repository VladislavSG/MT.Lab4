grammar Calculator;

e local[Integer res = 0]
    : s s0[$0::res] {$res = $1::res;} ;

s0[Integer acc]
    local[Integer res]
    : '+' s {acc += $0::res;} s0[acc] {$res = $1::res;}
    | '-' s {acc -= $0::res;} s0[acc] {$res = $1::res;}
    | {$res = acc;} ;

s local[Integer res] 
    : m m0[$0::res] {$res = $1::res;} ;

m0[Integer acc]
    local[Integer res]
    : '*' m {acc *= $0::res;} m0[acc] {$res = $1::res;}
    | '/' m {acc /= $0::res;} m0[acc] {$res = $1::res;}
    | {$res = acc;} ;

m local[Integer res]
    :  int0 {$res = $0::res;}
    | '(' e ')' {$res = $0::res;} ;

int0 local[Integer res = 0]
    : digit int1 ;
int1 : digit int1 | ;
digit : '0' {$int0::res = $int0::res * 10 + 0;}
      | '1' {$int0::res = $int0::res * 10 + 1;}
      | '2' {$int0::res = $int0::res * 10 + 2;}
      | '3' {$int0::res = $int0::res * 10 + 3;}
      | '4' {$int0::res = $int0::res * 10 + 4;}
      | '5' {$int0::res = $int0::res * 10 + 5;}
      | '6' {$int0::res = $int0::res * 10 + 6;}
      | '7' {$int0::res = $int0::res * 10 + 7;}
      | '8' {$int0::res = $int0::res * 10 + 8;}
      | '9' {$int0::res = $int0::res * 10 + 9;} ;
